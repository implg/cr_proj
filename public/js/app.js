$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.datetimepicker.setLocale("ru"),$(".datetimepicker").datetimepicker(),$(".datetimepicker2").datetimepicker({format:"Y-m-d H:i:s"}),$.material.init(),$(".tooltip").tooltip()}),$(document).ready(function(){$("#split").split({orientation:"horizontal",limit:10}),$("body").on("click",".event_edit",function(t){var e=$(this).data("event-id");$.get("/events/"+e+"/edit",function(t){$(".update_modal_event .modal-content").html(t),$(".update_modal_event").modal("show"),$.material.init(),setTimeout(function(){$(".datetimepicker3").datetimepicker(),$(".datetimepicker3").datetimepicker("show"),setTimeout(function(){$(".datetimepicker3").datetimepicker("hide")},100)},700)})}),$("body").on("submit",".events_update",function(t){t.preventDefault();var e=$(this).find("input[type=submit]").data("event-id"),i=$(this).find(".responsible_id").val(),n=$(".add_event").data("company-id"),o=$(this).find(".event_type").val(),r=$(this).find(".event_text").val(),a=$(this).find(".taskComplete").val(),s=$(this).find(".event_date").val(),l=$(this).find(".event_status").val(),c=$(".event_reminder").prop("checked")?1:0;$.ajax({url:"/events/"+e,type:"put",data:{responsible_id:i,company_id:n,type:o,text:r,taskComplete:a,date:s,reminder:c,status:l},success:function(t){$(".update_modal_event").modal("hide"),n?$.ajax({url:"events-company/"+n,type:"get",data:{companyId:n},success:function(t){$("#events").html(t)}}):window.location.reload()}})}),$("body").on("click",".event-destroy",function(){var t=$(this).data("event-id"),e=$(this).closest("tr");$.confirm({title:"Удалить предприятие",theme:"black",confirmButton:"Удалить",cancelButton:"Отмена",content:"Вы уверены, что хотите удалить это событие?<br>Эта операция не восстановима.",confirm:function(){$.ajax({url:"events/"+t,type:"delete",success:function(t){e.fadeOut(400,function(){e.remove()})}})}})}),$(document).on("change",".change_task #status",function(){var t=$(this).val();2==t&&$(".comment-task-complete").slideDown()})}),function(t,e){var i=0,n=null,o=[],r=null;t.fn.split=function(a){function s(t){if("number"==typeof t)return t;if("string"==typeof t){var e=t.match(/^([0-9\.]+)(px|%)$/);if(e){if("px"==e[2])return+e[1];if("vertical"==d.orientation)return h*+e[1]/100;if("horizontal"==d.orientation)return m*+e[1]/100}}}var l=this.data("splitter");if(l)return l;var c,u,d=t.extend({limit:100,orientation:"horizontal",position:"50%",invisible:!1,onDragStart:t.noop,onDragEnd:t.noop,onDrag:t.noop},a||{});this.settings=d;var p,f=this.children();"vertical"==d.orientation?(c=f.first().addClass("left_panel"),u=c.next().addClass("right_panel"),p="vsplitter"):"horizontal"==d.orientation&&(c=f.first().addClass("top_panel"),u=c.next().addClass("bottom_panel"),p="hsplitter"),d.invisible&&(p+=" splitter-invisible");var h=this.width(),m=this.height(),v=i++;this.addClass("splitter_panel");var g,b=t("<div/>").addClass(p).bind("mouseenter touchstart",function(){n=v}).bind("mouseleave touchend",function(){n=null}).insertAfter(c),$=t.extend(this,{refresh:function(){var t=this.width(),e=this.height();h==t&&m==e||(h=this.width(),m=this.height(),$.position(g))},position:function(){return"vertical"==d.orientation?function(t,i){if(t===e)return g;g=s(t);var n,o=b.width(),r=o/2;return d.invisible?(n=c.width(g).outerWidth(),u.width($.width()-n),b.css("left",n-r)):(n=c.width(g-r).outerWidth(),u.width($.width()-n-o),b.css("left",n)),i||($.trigger("splitter.resize"),$.find(".splitter_panel").trigger("splitter.resize")),$}:"horizontal"==d.orientation?function(t,i){if(t===e)return g;g=s(t);var n,o=b.height(),r=o/2;return d.invisible?(n=c.height(g).outerHeight(),u.height($.height()-n),b.css("top",n-r)):(n=c.height(g-r).outerHeight(),u.height($.height()-n-o),b.css("top",n)),i||($.trigger("splitter.resize"),$.find(".splitter_panel").trigger("splitter.resize")),$}:t.noop}(),orientation:d.orientation,limit:d.limit,isActive:function(){return n===v},destroy:function(){$.removeClass("splitter_panel"),b.unbind("mouseenter"),b.unbind("mouseleave"),b.unbind("touchstart"),b.unbind("touchmove"),b.unbind("touchend"),b.unbind("touchleave"),b.unbind("touchcancel"),"vertical"==d.orientation?(c.removeClass("left_panel"),u.removeClass("right_panel")):"horizontal"==d.orientation&&(c.removeClass("top_panel"),u.removeClass("bottom_panel")),$.unbind("splitter.resize"),$.trigger("splitter.resize"),$.find(".splitter_panel").trigger("splitter.resize"),o[n]=null,i--,b.remove(),$.removeData("splitter");for(var e=!1,n=o.length;n--;)if(null!==o[n]){e=!0;break}e||(t(document.documentElement).unbind(".splitter"),t(window).unbind("resize.splitter"),o=[],i=0)}});$.bind("splitter.resize",function(t){var e=$.position();"vertical"==$.orientation&&e>$.width()?e=$.width()-$.limit-1:"horizontal"==$.orientation&&e>$.height()&&(e=$.height()-$.limit-1),e<$.limit&&(e=$.limit+1),t.stopPropagation(),$.position(e,!0)});var w;return"vertical"==d.orientation?w=w>h-d.limit?h-d.limit:s(d.position):"horizontal"==d.orientation&&(w=w>m-d.limit?m-d.limit:s(d.position)),w<d.limit&&(w=d.limit),$.position(w,!0),0===o.length&&(t(window).bind("resize.splitter",function(){t.each(o,function(t,e){e&&e.refresh()})}),t(document.documentElement).on("mousedown.splitter touchstart.splitter",function(e){null!==n&&(r=o[n],setTimeout(function(){t('<div class="splitterMask"></div>').css("cursor",r.children().eq(1).css("cursor")).insertAfter(r)}),r.settings.onDragStart(e))}).bind("mouseup.splitter touchend.splitter touchleave.splitter touchcancel.splitter",function(e){r&&(setTimeout(function(){t(".splitterMask").remove()}),r.settings.onDragEnd(e),r=null)}).bind("mousemove.splitter touchmove.splitter",function(t){if(null!==r){var e=r.limit,i=r.offset();if("vertical"==r.orientation){var n=t.pageX;t.originalEvent&&t.originalEvent.changedTouches&&(n=t.originalEvent.changedTouches[0].pageX);var o=n-i.left;o<=r.limit?o=r.limit+1:o>=r.width()-e&&(o=r.width()-e-1),o>r.limit&&o<r.width()-e&&(r.position(o,!0),r.trigger("splitter.resize"),r.find(".splitter_panel").trigger("splitter.resize"))}else if("horizontal"==r.orientation){var a=t.pageY;t.originalEvent&&t.originalEvent.changedTouches&&(a=t.originalEvent.changedTouches[0].pageY);var s=a-i.top;s<=r.limit?s=r.limit+1:s>=r.height()-e&&(s=r.height()-e-1),s>r.limit&&s<r.height()-e&&(r.position(s,!0),r.trigger("splitter.resize"),r.find(".splitter_panel").trigger("splitter.resize"))}r.settings.onDrag(t)}})),o[v]=$,$.data("splitter",$),$}}(jQuery),function(){$(".full-access").prop("checked")||$(".not-full-access").show(),$(".full-access").on("click",function(){$(".full-access").prop("checked")?$(".not-full-access").hide():$(".not-full-access").show()})}(),function(t,e){"use strict";var i=function(e,i){var n=e.ajax.url()||"",o=e.ajax.params();return o.action=i,n+"?"+t.param(o)};e.ext.buttons.excel={className:"buttons-excel",text:function(t){return'<i class="fa fa-file-excel-o"></i> '+t.i18n("buttons.excel","Excel")},action:function(t,e,n,o){var r=i(e,"excel");window.location=r}},e.ext.buttons.csv={className:"buttons-csv",text:function(t){return'<i class="fa fa-file-excel-o"></i> '+t.i18n("buttons.csv","CSV")},action:function(t,e,n,o){var r=i(e,"csv");window.location=r}},e.ext.buttons.pdf={className:"buttons-pdf",text:function(t){return'<i class="fa fa-file-pdf-o"></i> '+t.i18n("buttons.pdf","PDF")},action:function(t,e,n,o){var r=i(e,"pdf");window.location=r}},e.ext.buttons.print={className:"buttons-print",text:function(t){return'<i class="fa fa-print"></i> '+t.i18n("buttons.print","Print")},action:function(t,e,n,o){var r=i(e,"print");window.location=r}},e.ext.buttons.reset={className:"buttons-reset",text:function(t){return'<i class="fa fa-undo"></i> '+t.i18n("buttons.reset","Reset")},action:function(t,e,i,n){e.search("").draw()}},e.ext.buttons.reload={className:"buttons-reload",text:function(t){return'<i class="fa fa-refresh"></i> '+t.i18n("buttons.reload","Reload")},action:function(t,e,i,n){e.draw(!1)}},e.ext.buttons.create={className:"buttons-create",text:function(t){return'<i class="fa fa-plus"></i> '+t.i18n("buttons.create","Create")},action:function(t,e,i,n){window.location=window.location.href.replace(/\/+$/,"")+"/create"}}}(jQuery,jQuery.fn.dataTable);